<h2>Please, import location and magnetometer data</h2>

<div>
    <%=form_tag import_mags_path, multipart: true do%>
      <%= file_field_tag :file %>
      <%= file_field_tag :file1 %>
      <%= submit_tag "Import data"%>
    <%end%>
</div>
<div>

</div>
<%= flash[:notice]%>
<div>
  <%= line_chart [
    { name: "Magnetometer Data",
      data: Mag.pluck(:id,:vector_mag), points: false},
    { name: "NORMAL_MAX",
      data: Mag.pluck(:id, 65), points: false},
    { name: "NORMAL_MIN",
      data: Mag.pluck(:id, 25), points: false},
  ], colors: ["#003ebb", "#b00", "#b00"]%>
</div>
<%mag_anomaly_detect = mad(@mags)%>
<div>
  <%= scatter_chart [
    { name: "Magnetic anomaly Location",
      data: mag_anomaly_detect.pluck(:x_loc, :y_loc)},
    { name: "Platform movement",
      data: Mag.pluck(:x_loc, :y_loc)}
  ], colors: ["#e30000", "#00bb3e"]%>
</div>
<div>
  <table>
    <thead>
      <tr>
        <th>X - platform position</th>
        <th>Y - platform position</th>
        <th>Z - magnetometer data in this spot</th>
      </tr>
    </thead>
    <tbody>
      <%if @mags.first != nil%>
        <%mag_anomaly_detect.each do |mags|%>
          <tr>
              <td><%=mags.x_loc %></td>
              <td><%=mags.y_loc %></td>
              <td><%=mags.vector_mag %></td>
            </tr>
        <%end%>
      <%end%>
    </tbody>
  </table>
</div>
